<!-- The global progress bar -->
<div class="fileupload--details fileupload--details--hidden"><!-- The container for the uploaded files -->
	<div class="progress">
		<div class="progress-bar progress-bar-striped progress-bar-animated active"></div>
	</div>
	<div class="fileupload--files">
		<p class="fileupload--filename">&nbsp;</p>
	</div>
</div>

<%= simple_form_for [ @instance.structure, @instance ], html: { class: 'form-body',multipart: true } do |f| %>

  <%= f.error_notification %>

  <%# - - - - - - - - - - - - %>
  <%# SET POSITION            %>
  <%# - - - - - - - - - - - - %>
  <% unless f.object.new_record? %>
    <%= f.input :position, as: :hidden %>
  <% end %>

  <div class="standard-form--body">

    <%# - - - - - - - - - - - - %>
    <%# NOTICE / ERRORS         %>
    <%# - - - - - - - - - - - - %>
    <div class="standard-form--container">

        <div class="standard-form--header">
          <p><%= "#{ t :details }".capitalize %></p>
        </div>

        <div class="standard-form--fields">

          <%= f.input :name, label: "#{t('binda.title')}".capitalize %>

          <% if f.object.slug.nil? %>
            <%= f.input :slug, as: :hidden %>
          <% else %>
            <%= f.input :slug, disabled: true, hint: "#{ t :slug_disable_hint }" %>
          <% end %>

          <%= f.input :structure_id, as: :hidden, input_html: { value: @structure.id } %>

        </div>

    </div>

    <%# - - - - - - - - - - - - %>
    <%# FIELD GROUP LOOP        %>
    <%# - - - - - - - - - - - - %>
    <% @structure.field_groups.order( :position, :name ).each_with_index do |field_group, index| %>

      <div class="standard-form--container">

          <div class="standard-form--header">
            <p><%= field_group.name.capitalize %></p>
          </div>

          <% if f.object.new_record? %>

            <p><%= t( :hint_create_parent_before_child, arg1: "#{ t :instance }", arg2: "#{ t :detail }" ).capitalize %></p>

          <% else %>

            <% field_group.field_settings.order( :position, :name ).each do |field_setting| %>
              <% next unless field_setting.is_root? %>
              <%= render "binda/fieldable/form_section", f: f, field_setting: field_setting %>
            <% end %>

          <% end %>

      </div>

    <% end %>
  </div>

  <%# - - - - - - - - - - - - %>
  <%# SIDEBAR                 %>
  <%# - - - - - - - - - - - - %>
  <div class="standard-form--container standard-form--sidebar">

    <%= render "binda/fieldable/form_sidebar", f: f %>

  </div>

<% end %>
